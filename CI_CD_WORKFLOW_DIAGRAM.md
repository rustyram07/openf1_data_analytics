# CI/CD Workflow Diagram

**Visual guide to the automated CI/CD pipeline**

---

## Complete Workflow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           DEVELOPMENT WORKFLOW                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

    Developer                     GitHub                      Databricks
        â”‚                            â”‚                            â”‚
        â”‚                            â”‚                            â”‚
  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                      â”‚                            â”‚
  â”‚  Create   â”‚                      â”‚                            â”‚
  â”‚  Feature  â”‚                      â”‚                            â”‚
  â”‚  Branch   â”‚                      â”‚                            â”‚
  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â”‚                            â”‚
        â”‚                            â”‚                            â”‚
        â”‚  git checkout -b           â”‚                            â”‚
        â”‚  feature/new-model         â”‚                            â”‚
        â”‚                            â”‚                            â”‚
  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                      â”‚                            â”‚
  â”‚   Edit    â”‚                      â”‚                            â”‚
  â”‚   dbt     â”‚                      â”‚                            â”‚
  â”‚  Models   â”‚                      â”‚                            â”‚
  â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â”‚                            â”‚
        â”‚                            â”‚                            â”‚
        â”‚  Test locally:             â”‚                            â”‚
        â”‚  ./run_dbt.sh build        â”‚                            â”‚
        â”‚                            â”‚                            â”‚
  â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                      â”‚                            â”‚
  â”‚   Push    â”‚                      â”‚                            â”‚
  â”‚    to     â”‚                      â”‚                            â”‚
  â”‚  GitHub   â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚                            â”‚
  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   git push           â”‚                            â”‚
                                     â”‚                            â”‚
                               â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”                      â”‚
                               â”‚  Create   â”‚                      â”‚
                               â”‚    PR     â”‚                      â”‚
                               â”‚  to dev   â”‚                      â”‚
                               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                      â”‚
                                     â”‚                            â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CI PIPELINE (Stage)                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚                            â”‚
                               â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                     â”‚
                               â”‚  Trigger   â”‚                     â”‚
                               â”‚  GitHub    â”‚                     â”‚
                               â”‚  Actions   â”‚                     â”‚
                               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                                     â”‚                            â”‚
                               â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                     â”‚
                               â”‚  Install   â”‚                     â”‚
                               â”‚   Python   â”‚                     â”‚
                               â”‚    & dbt   â”‚                     â”‚
                               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                                     â”‚                            â”‚
                               â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                     â”‚
                               â”‚    dbt     â”‚                     â”‚
                               â”‚    deps    â”‚                     â”‚
                               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                                     â”‚                            â”‚
                               â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”        Connect     â”‚
                               â”‚    dbt     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚
                               â”‚   debug    â”‚        stage        â”‚
                               â”‚  --target  â”‚    catalog          â”‚
                               â”‚   stage    â”‚                     â”‚
                               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                                     â”‚                            â”‚
                               â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                     â”‚
                               â”‚    dbt     â”‚                     â”‚
                               â”‚  compile   â”‚                     â”‚
                               â”‚  --target  â”‚                     â”‚
                               â”‚   stage    â”‚                     â”‚
                               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                                     â”‚                            â”‚
                               â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”      Execute       â”‚
                               â”‚    dbt     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶ â”‚
                               â”‚   build    â”‚     queries on      â”‚
                               â”‚  --target  â”‚    stage_f1_data    â”‚
                               â”‚   stage    â”‚    _analytics       â”‚
                               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                                     â”‚            â–²               â”‚
                                     â”‚            â”‚               â”‚
                                     â”‚      Test Results          â”‚
                                     â”‚            â”‚               â”‚
                               â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
                               â”‚   Generate â”‚                     â”‚
                               â”‚    docs &  â”‚                     â”‚
                               â”‚  artifacts â”‚                     â”‚
                               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                                     â”‚                            â”‚
                               â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                     â”‚
                               â”‚   Post PR  â”‚                     â”‚
                               â”‚  Comment   â”‚                     â”‚
                               â”‚   with     â”‚                     â”‚
                               â”‚  Results   â”‚                     â”‚
                               â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                                     â”‚                            â”‚
                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
                            â”‚                 â”‚                   â”‚
                      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”             â”‚
                      â”‚  âœ… PASS  â”‚     â”‚ âŒ FAIL  â”‚             â”‚
                      â”‚           â”‚     â”‚          â”‚             â”‚
                      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜             â”‚
                            â”‚                â”‚                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”            â”‚
                    â”‚  Merge to    â”‚   â”‚   Fix      â”‚            â”‚
                    â”‚     dev      â”‚   â”‚   Issues   â”‚            â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
                            â”‚                                    â”‚
                            â”‚                                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    STAGING PHASE (dev branch)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚                                    â”‚
                      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                             â”‚
                      â”‚  Manual    â”‚                             â”‚
                      â”‚  Testing   â”‚                             â”‚
                      â”‚  in Stage  â”‚                             â”‚
                      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                             â”‚
                            â”‚                                    â”‚
                      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                             â”‚
                      â”‚  Ready for â”‚                             â”‚
                      â”‚ Production?â”‚                             â”‚
                      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                             â”‚
                            â”‚                                    â”‚
                      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                             â”‚
                      â”‚  Create PR â”‚                             â”‚
                      â”‚    from    â”‚                             â”‚
                      â”‚  dev â†’ mainâ”‚                             â”‚
                      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                             â”‚
                            â”‚                                    â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          CD PIPELINE (Production)                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚                                    â”‚
                      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                             â”‚
                      â”‚  Trigger   â”‚                             â”‚
                      â”‚  GitHub    â”‚                             â”‚
                      â”‚  Actions   â”‚                             â”‚
                      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                             â”‚
                            â”‚                                    â”‚
                      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”        Connect              â”‚
                      â”‚    dbt     â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶  â”‚
                      â”‚   build    â”‚       prod_f1_data          â”‚
                      â”‚  --target  â”‚       _analytics            â”‚
                      â”‚    prod    â”‚                             â”‚
                      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                             â”‚
                            â”‚              â–²                     â”‚
                            â”‚              â”‚                     â”‚
                            â”‚        Test Results                â”‚
                            â”‚              â”‚                     â”‚
                      â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â”‚
                      â”‚   Post PR  â”‚                             â”‚
                      â”‚  Comment   â”‚                             â”‚
                      â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                             â”‚
                            â”‚                                    â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
                   â”‚                  â”‚                          â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                  â”‚
            â”‚  âœ… PASS    â”‚    â”‚  âŒ FAIL    â”‚                  â”‚
            â”‚             â”‚    â”‚             â”‚                  â”‚
            â”‚ All tests   â”‚    â”‚  DO NOT     â”‚                  â”‚
            â”‚ passed!     â”‚    â”‚  MERGE!     â”‚                  â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
                   â”‚                                             â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                                      â”‚
            â”‚  Approve &  â”‚                                      â”‚
            â”‚   Merge to  â”‚                                      â”‚
            â”‚    main     â”‚                                      â”‚
            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜                                      â”‚
                   â”‚                                             â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                  â”‚
         â”‚                   â”‚                                  â”‚
         â”‚  ğŸ‰ PRODUCTION    â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚    DEPLOYED!      â”‚     Models materialized in
         â”‚                   â”‚     prod_f1_data_analytics
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

```

---

## Catalog Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        DATABRICKS CATALOGS                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  dev_f1_data_analytics  â”‚  â† Developer workstation
â”‚  (Development)          â”‚     (./run_dbt.sh build)
â”‚                         â”‚
â”‚  â€¢ bronze_raw           â”‚
â”‚  â€¢ silver_clean         â”‚
â”‚  â€¢ gold_analytics       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Feature complete
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ stage_f1_data_analytics â”‚  â† GitHub Actions CI
â”‚  (Staging/Testing)      â”‚     (PR to dev)
â”‚                         â”‚
â”‚  â€¢ bronze_raw           â”‚     dbt build --target stage
â”‚  â€¢ silver_clean         â”‚
â”‚  â€¢ gold_analytics       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Tests pass + Manual verification
            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ prod_f1_data_analytics  â”‚  â† GitHub Actions CD
â”‚  (Production)           â”‚     (PR to main)
â”‚                         â”‚
â”‚  â€¢ bronze_raw           â”‚     dbt build --target prod
â”‚  â€¢ silver_clean         â”‚
â”‚  â€¢ gold_analytics       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â”‚ Analytics & Dashboards
            â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚   BI Tools  â”‚
     â”‚  Dashboards â”‚
     â”‚  ML Models  â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Git Branch Strategy

```
main (Protected)
  â”‚
  â”‚  PR from dev â†’ Triggers CD (prod)
  â”‚  âœ… All tests must pass
  â”‚  âœ… Requires approval
  â”‚
  â”œâ”€â”€â”€ dev (Default Branch)
  â”‚     â”‚
  â”‚     â”‚  PR from feature â†’ Triggers CI (stage)
  â”‚     â”‚  âœ… All tests must pass
  â”‚     â”‚  âœ… Code review
  â”‚     â”‚
  â”‚     â”œâ”€â”€â”€ feature/add-new-model
  â”‚     â”‚
  â”‚     â”œâ”€â”€â”€ feature/fix-data-quality
  â”‚     â”‚
  â”‚     â””â”€â”€â”€ feature/update-transformations
```

---

## Data Flow per Environment

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚    OpenF1 API           â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Bronze Layer (Raw)     â”‚
                    â”‚   bronze_raw schema      â”‚
                    â”‚                          â”‚
                    â”‚  â€¢ bronze_sessions       â”‚
                    â”‚  â€¢ bronze_drivers        â”‚
                    â”‚  â€¢ bronze_laps           â”‚
                    â”‚  â€¢ bronze_locations      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚  dbt models
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Silver Layer (Cleaned)  â”‚
                    â”‚  silver_clean schema     â”‚
                    â”‚                          â”‚
                    â”‚  â€¢ silver_sessions       â”‚
                    â”‚  â€¢ silver_drivers        â”‚
                    â”‚  â€¢ silver_laps           â”‚
                    â”‚  â€¢ silver_locations      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â”‚  dbt models
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Gold Layer (Analytics)   â”‚
                    â”‚ gold_analytics schema    â”‚
                    â”‚                          â”‚
                    â”‚  Core:                   â”‚
                    â”‚  â€¢ dim_sessions          â”‚
                    â”‚  â€¢ dim_drivers           â”‚
                    â”‚  â€¢ fact_laps             â”‚
                    â”‚                          â”‚
                    â”‚  Marts:                  â”‚
                    â”‚  â€¢ session_leaderboard   â”‚
                    â”‚  â€¢ driver_session_summaryâ”‚
                    â”‚  â€¢ team_performance      â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Dashboards & Reports   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

This same structure exists in all three catalogs:
â€¢ dev_f1_data_analytics
â€¢ stage_f1_data_analytics
â€¢ prod_f1_data_analytics
```

---

## GitHub Actions Job Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   GitHub Actions Runner                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Step 1: Setup
  â”œâ”€ Checkout code from GitHub
  â”œâ”€ Set up Python 3.11
  â””â”€ Install dbt-databricks + dbt-utils

Step 2: dbt Dependencies
  â””â”€ Run: dbt deps
      â””â”€ Downloads: dbt-utils, other packages

Step 3: Connection Test
  â””â”€ Run: dbt debug --target {stage|prod}
      â”œâ”€ Tests Databricks connection
      â”œâ”€ Validates credentials
      â””â”€ Checks catalog access

Step 4: SQL Compilation
  â””â”€ Run: dbt compile --target {stage|prod}
      â”œâ”€ Compiles all Jinja templates
      â”œâ”€ Generates raw SQL
      â””â”€ Validates syntax

Step 5: Build & Test
  â””â”€ Run: dbt build --target {stage|prod}
      â”œâ”€ Runs all models
      â”‚   â”œâ”€ Bronze sources
      â”‚   â”œâ”€ Silver models (incremental)
      â”‚   â””â”€ Gold models (tables)
      â”œâ”€ Runs all tests
      â”‚   â”œâ”€ Source tests
      â”‚   â”œâ”€ Model tests
      â”‚   â””â”€ Custom tests
      â””â”€ Runs snapshots

Step 6: Documentation
  â””â”€ Run: dbt docs generate
      â”œâ”€ Creates manifest.json
      â”œâ”€ Creates catalog.json
      â””â”€ Generates lineage

Step 7: Upload Artifacts
  â””â”€ Saves:
      â”œâ”€ manifest.json
      â”œâ”€ catalog.json
      â”œâ”€ run_results.json
      â””â”€ logs/dbt.log

Step 8: PR Comment
  â””â”€ Posts summary:
      â”œâ”€ Total models run
      â”œâ”€ Success count
      â”œâ”€ Error count
      â”œâ”€ Execution time
      â””â”€ Link to artifacts

```

---

## Testing Stages

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         TESTING PYRAMID                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Level 4: Production Validation (CD Pipeline)
  â”‚
  â”‚  â€¢ dbt build --target prod
  â”‚  â€¢ Validates against production data
  â”‚  â€¢ Final check before merge
  â”‚  â€¢ Fails PR if tests fail
  â”‚
  â””â”€â–¶ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  prod_f1_data_analytics catalog     â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Level 3: Integration Testing (CI Pipeline)
  â”‚
  â”‚  â€¢ dbt build --target stage
  â”‚  â€¢ Tests data transformations
  â”‚  â€¢ Validates business logic
  â”‚  â€¢ Checks data quality
  â”‚
  â””â”€â–¶ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  stage_f1_data_analytics catalog    â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Level 2: Local Testing
  â”‚
  â”‚  â€¢ ./run_dbt.sh build
  â”‚  â€¢ Developer workstation
  â”‚  â€¢ Quick iteration
  â”‚  â€¢ Debug queries
  â”‚
  â””â”€â–¶ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  dev_f1_data_analytics catalog      â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Level 1: SQL Compilation
  â”‚
  â”‚  â€¢ dbt compile
  â”‚  â€¢ Syntax validation
  â”‚  â€¢ Template rendering
  â”‚  â€¢ No database execution
  â”‚
  â””â”€â–¶ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  Local only (no database)           â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Timeline Example

```
Day 1: Monday
  09:00 - Developer creates feature/improve-lap-analysis
  10:30 - Makes changes to fact_laps model
  11:00 - Tests locally: ./run_dbt.sh build
  11:30 - Pushes to GitHub
  11:35 - Creates PR to dev
  11:36 - ğŸ¤– CI pipeline starts automatically
  11:42 - âœ… CI passes, posts results in PR
  14:00 - Code review + approval
  14:30 - Merges to dev

Day 2: Tuesday
  09:00 - QA team tests in stage catalog
  11:00 - Validates with stakeholders
  14:00 - Creates PR from dev to main
  14:01 - ğŸ¤– CD pipeline starts automatically
  14:08 - âœ… CD passes, ready for production
  15:00 - Final approval + merge to main
  15:01 - ğŸ‰ Production deployed!

Day 3: Wednesday
  10:00 - Dashboards updated with new data
  11:00 - Stakeholders see improvements
```

---

## Success Criteria Checklist

Before merging to production, verify:

```
CI Stage (PR to dev)
  âœ… All models compile successfully
  âœ… All models build without errors
  âœ… All data tests pass
  âœ… dbt docs generate successful
  âœ… Code review completed
  âœ… Conversation resolved

CD Stage (PR to main)
  âœ… All CI checks passed
  âœ… Manual testing in stage complete
  âœ… Data quality validated
  âœ… No breaking schema changes
  âœ… Stakeholders notified
  âœ… Rollback plan prepared
  âœ… All production tests pass
  âœ… Final approval obtained
```

---

**For detailed setup instructions, see**: [CI_CD_SETUP_GUIDE.md](CI_CD_SETUP_GUIDE.md)
